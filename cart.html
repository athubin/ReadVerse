<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <style>
        .cart-img {
            width: 80px;
            height: 110px;
            object-fit: cover;
            border-radius: 6px;
        }
    </style>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4">
    <a class="navbar-brand fw-bold" href="home.html">ReadVerse</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto align-items-center">
            <li class="nav-item"><a class="nav-link" href="home.html">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="products.html">Shop</a></li>
            <li class="nav-item"><a class="nav-link active" href="cart.html">Cart</a></li>
            <li class="nav-item">
                <a class="nav-link text-danger" href="#" id="logoutBtn">Logout</a>
            </li>
        </ul>
    </div>
</nav>

<div class="container my-5">
    <h3>Your Cart</h3>
    <div id="cartItems"></div>
    <h4 class="text-end mt-3" id="grandTotal">Total: ₹0</h4>
</div>

<script>
function loadCart() {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    let container = document.getElementById("cartItems");
    container.innerHTML = "";

    let total = 0;

    cart.forEach((item, i) => {
        total += item.price * item.qty;

        container.innerHTML += `
        <div class="row bg-white shadow-sm p-3 mb-3 rounded">
            <div class="col-3">
                <img src="${item.image}" class="cart-img">
            </div>

            <div class="col-5">
                <h6>${item.name}</h6>
                <p class="text-muted">₹${item.price}</p>
            </div>

            <div class="col-2">
                <input type="number" min="1" class="form-control" 
                       value="${item.qty}" onchange="updateQty(${i}, this.value)">
            </div>

            <div class="col-2">
                <button class="btn btn-danger" onclick="removeItem(${i})">X</button>
            </div>
        </div>
        `;
    });

    document.getElementById("grandTotal").innerText = "Total: ₹" + total;
}

function updateQty(i, qty) {
    let cart = JSON.parse(localStorage.getItem("cart"));
    cart[i].qty = parseInt(qty);
    localStorage.setItem("cart", JSON.stringify(cart));
    loadCart();
}

function removeItem(i) {
    let cart = JSON.parse(localStorage.getItem("cart"));
    cart.splice(i, 1);
    localStorage.setItem("cart", JSON.stringify(cart));
    loadCart();
}

loadCart();

document.getElementById("logoutBtn")?.addEventListener("click", function () {
    // Clear login session
    localStorage.removeItem("currentUser");

    // Optional: clear cart
    // localStorage.removeItem("cart");

    alert("Logged out successfully!");

    // Redirect to login page
    window.location.href = "login.html";
});

</script>

</body>
</html>
